import React, { createContext, useCallback, useContext, useEffect, useMemo, useState } from 'react';

export type Language = 'en' | 'vi';

type Dict = Record<string, string>;

const en: Dict = {
  'app.title': 'Indoor Autonomous Vehicle',
  'status.connected': 'ğŸŸ¢ Connected',
  'status.connecting': 'ğŸŸ¡ Connecting...',
  'status.disconnected': 'ğŸ”´ Disconnected',

  // Pages
  'page.dashboard': 'Dashboard',
  'page.robot-control': 'Robot Control',
  'page.navigation': 'Navigation',
  'page.sensors': 'Sensors',
  'page.map-2d': '2D Map View',
  'page.map-3d': '3D Visualization',
  'page.map-editor': 'Map Editor',
  'page.map-management-status': 'Current Status',
  'page.map-management-maps': 'Map Management',
  'page.map-management-tasks': 'Task Management',
  'page.charts': 'Real-time Charts',
  'page.diagnostics': 'Diagnostics',
  'page.logs': 'System Logs',
  'page.parameters': 'Parameters',
  'page.nodes': 'Node Manager',
  'page.system-status': 'System Status',
  'page.system-guide': 'System Guide',

  // Dashboard
  'dashboard.title': 'Dashboard',
  'dashboard.subtitle': 'Quick overview and essential controls',
  'dashboard.battery': 'Battery',
  'dashboard.speed': 'Speed',
  'dashboard.position': 'Position',
  'dashboard.lidar': 'LiDAR',
  'dashboard.lidar_points': 'points detected',
  'dashboard.robot_status': 'Robot Status',
  'dashboard.current_position': 'Current Position',
  'dashboard.movement': 'Movement',
  'dashboard.speed_label': 'Speed',
  'dashboard.status': 'Status',
  'dashboard.moving': 'ğŸŸ¢ Moving',
  'dashboard.stopped': 'â¸ï¸ Stopped',
  'dashboard.power': 'Power',
  'dashboard.nav_status': 'Navigation Status',
  'dashboard.current_goal': 'Current Goal',
  'dashboard.goal_status': 'Status',
  'dashboard.no_active_goal': 'No active goal',
  'dashboard.map_status': 'Map Status',
  'dashboard.map_loaded': 'ğŸŸ¢ Map loaded',
  'dashboard.no_map': 'ğŸ”´ No map',
  'dashboard.path_planning': 'Path Planning',
  'dashboard.ready_for_nav': 'Ready for navigation',
  'dashboard.system_health': 'System Health',
  'dashboard.connections': 'Connections',
  'dashboard.ros_nodes': 'ROS Nodes',
  'dashboard.active_nodes': 'Active',
  'dashboard.nodes': 'nodes',
  'dashboard.diagnostics': 'Diagnostics',
  'dashboard.all_ok': 'ğŸŸ¢ All systems OK',
  'dashboard.no_diag': 'ğŸŸ¡ No diagnostics',
  'dashboard.quick_actions': 'Quick Actions',
  'dashboard.emergency_stop': 'ğŸ›‘ Emergency Stop',
  'dashboard.go_home': 'ğŸ  Go Home',
  'dashboard.start_nav': 'ğŸš€ Start Navigation',
  'dashboard.system_overview': 'System Overview',
  'dashboard.websocket_conn': 'WebSocket Connection',
  'dashboard.ros_nodes_count': 'ROS Nodes',
  'dashboard.lidar_sensor': 'LiDAR Sensor',
  'dashboard.odometry': 'Odometry',

  // Robot Control
  'rc.title': 'Robot Control',
  'rc.subtitle': 'Manual control and movement commands',
  'rc.mode.buttons': 'ğŸ”˜ Button Control',
  'rc.mode.basic': 'ğŸ® Basic Joystick',
  'rc.mode.advanced': 'ğŸš€ Advanced Joystick',
  'rc.robot_status': 'Robot Status',
  'rc.position': 'Position',
  'rc.orientation': 'Orientation',
  'rc.velocity': 'Velocity',
  'rc.battery': 'Battery',
  'rc.level': 'Level',
  'rc.voltage': 'Voltage',
  'rc.sensors': 'Sensors',
  'rc.lidar_points': 'LiDAR Points',
  'rc.emergency': 'Emergency Controls',
  'rc.emergency_stop': 'ğŸ›‘ EMERGENCY STOP',
  'rc.stop_movement': 'â¹ï¸ Stop Movement',
  'rc.return_home': 'ğŸ  Return Home',
  'rc.instructions': 'Control Instructions',
  'rc.warn.not_connected': 'Robot not connected',
  'rc.speed_settings': 'Speed Settings',
  'rc.linear_speed': 'Linear Speed',
  'rc.angular_speed': 'Angular Speed',
  'rc.movement_control': 'Movement Control',
  'rc.stop': 'Stop',
  'rc.home': 'Home',
  'rc.set_pose': 'Set Pose',
  'rc.current_speed': 'Current Speed',
  'rc.current_angular': 'Angular',
  'rc.snack.moving': 'ğŸ® Moving',
  'rc.snack.stopped': 'â¹ï¸ Robot stopped',
  'rc.snack.returning_home': 'ğŸ  Returning home...',
  'rc.manual_control': 'Manual Control:',
  'rc.tip.use_buttons': 'Use arrow buttons for movement',
  'rc.tip.adjust_speed': 'Adjust speed with sliders',
  'rc.tip.emergency_stop': 'Emergency stop always available',
  'rc.tip.realtime_feedback': 'Real-time feedback on robot status',
  'rc.safety_notes': 'Safety Notes:',
  'rc.tip.monitor': 'Always monitor robot surroundings',
  'rc.tip.use_emg': 'Use emergency stop if needed',
  'rc.tip.check_battery': 'Check battery level regularly',
  'rc.tip.clear_path': 'Ensure clear path before movement',

  // Map 2D
  'map2d.title': '2D Map View',
  'map2d.refresh': 'Force refresh map data',
  'map2d.save_map': 'Save the current map',
  'map2d.rc_wasd': 'ğŸ® Robot Control (WASD)',
  'map2d.display_options': 'Display Options',
  'map2d.display_options_label': 'Display Options:',
  'map2d.show_lidar': 'Show LiDAR Scan',
  'map2d.show_path': 'Show Path',
  'map2d.show_goals': 'Show Goals',
  'map2d.auto_center': 'Auto Center on Robot',
  'map2d.quick_nav': 'Quick Navigation:',
  'map2d.go_home': 'ğŸ  Go Home (0, 0)',
  'map2d.point_a': 'ğŸ“ Point A (2, 2)',
  'map2d.point_b': 'ğŸ“ Point B (-2, 2)',
  'map2d.point_c': 'ğŸ“ Point C (0, -2)',
  'map2d.cancel_goal': 'âŒ Cancel Goal',
  'map2d.robot_status': 'Robot Status:',
  'map2d.mode.initial': 'Initial Pose',
  'map2d.mode.nav_goal': 'Nav Goal',
  // Map 2D - Controls
  'map2d.controls.title': 'ğŸ›ï¸ Map Controls',
  'map2d.controls.map_source_title': 'ğŸ—ºï¸ Map Data Source',
  'map2d.controls.static_map': 'Static Map',
  'map2d.controls.dynamic_map': 'Dynamic Map',
  'map2d.controls.map_source.desc.static': 'Using pre-built static map',
  'map2d.controls.map_source.desc.dynamic': 'Using real-time SLAM map',
  'map2d.controls.position_mode_title': 'ğŸ“ Robot Position Mode',
  'map2d.controls.receive_from_ros': 'Receive from ROS',
  'map2d.controls.send_to_ros': 'Send to ROS',
  'map2d.controls.position.desc.receive': 'Robot position updates from ROS',
  'map2d.controls.position.desc.send': 'Click map to set initial pose',
  'map2d.controls.position.alert': 'Click on the map to set robot initial position',
  'map2d.controls.running_mode_title': 'ğŸ¤– Robot Running Mode',
  'map2d.controls.line_following': 'Line Following',
  'map2d.controls.slam_auto': 'SLAM Auto',
  'map2d.controls.running.desc.line_following': 'Robot follows predefined paths',
  'map2d.controls.running.desc.slam': 'Autonomous navigation with SLAM',
  'map2d.controls.multi_goal_title': 'ğŸ“Œ Multi-Goal Mode (Cycle)',
  'map2d.controls.multiple_goals': 'Multiple Goals',
  'map2d.controls.single_goal': 'Single Goal',
  'map2d.controls.multi_goal.disabled': 'Disabled while setting initial pose',
  'map2d.controls.multi_goal.hint_multi': 'Pick multiple goals; drag to set direction',
  'map2d.controls.multi_goal.hint_single': 'Pick a single goal',
  'map2d.controls.selected': 'Selected',
  'map2d.controls.run': 'Run',
  'map2d.controls.clear': 'Clear',
  'map2d.wasd.press_to_move': 'Press WASD keys to move',
  // Map 2D - Legend
  'map2d.legend.title': 'ğŸ—‚ï¸ Map Legend & Instructions',
  'map2d.legend.elements_title': 'ğŸ¨ Map Elements:',
  'map2d.legend.green_circle': 'ğŸŸ¢ Green Circle: Robot position',
  'map2d.legend.blue_line': 'ğŸ”µ Blue Line: Robot direction',
  'map2d.legend.green_dots': 'ğŸŸ¢ Green Dots: LiDAR scan points',
  'map2d.legend.brown_rects': 'ğŸŸ¤ Brown Rectangles: Obstacles/walls',
  'map2d.legend.white_areas': 'âšª White Areas: Free space',
  'map2d.legend.gray_areas': 'ğŸ”² Gray Areas: Unknown space',
  'map2d.legend.interaction_title': 'ğŸ–±ï¸ Interaction:',
  'map2d.legend.interaction.click': 'Click: Set navigation goal',
  'map2d.legend.interaction.wasd': 'WASD Keys: Move robot directly',
  'map2d.legend.interaction.control_panel': 'Control Panel: Visual WASD in bottom-right',
  'map2d.legend.interaction.fullscreen': 'Fullscreen: Open in fullscreen mode',
  'map2d.legend.tips_title': 'âš ï¸ Control Tips:',
  'map2d.legend.tips.wasd': 'WASD: W=Forward, S=Back, A=Left, D=Right',
  'map2d.legend.tips.stop': 'Stop Button: Click red stop or release keys',
  'map2d.legend.tips.navigation': 'Navigation: Click on free (white) areas',
  'map2d.legend.tips.manual': 'Manual Control: Use WASD for precise positioning',
  'map2d.legend.tips.mapping': 'Map Building: Move robot to explore areas',
  'map2d.legend.tips.monitor': 'Monitor robot progress and avoid obstacles',
  'map.instruction.initial': 'ğŸ“ Click to set position, then click again to set direction',
  'map.instruction.goal': 'ğŸ“ Click on map to set navigation goal',
  'map.info.fallback': '(Using fallback map - no real map data from ROS)',
  'map.info.resolution': 'Resolution',
  'map.info.size': 'Size',
  'map.info.robot': 'Robot',
  'map.header.interactive': 'ğŸ—ºï¸ Interactive Map',
  'map.fullscreen': 'Fullscreen',
  'map.dialog.title': 'ğŸ—ºï¸ Map View - Fullscreen',
  'map.viewer.no_data.title': 'No Map Data',
  'map.viewer.no_data.subtitle': 'Map will appear when available',
  'map.viewer.zoom_in': 'Zoom +',
  'map.viewer.zoom_out': 'Zoom -',
  'map.viewer.reset': 'Reset',
  // Sidebar
  'sidebar.header.title': 'Autonomous Vehicle',
  'sidebar.header.subtitle': 'Web Control Interface',
  'sidebar.cat.main': 'ğŸ® Main Control',
  'sidebar.cat.monitoring': 'ğŸ“Š Monitoring',
  'sidebar.cat.tools': 'ğŸ”§ Tools',
  'sidebar.cat.system': 'âš™ï¸ System',
  'sidebar.dashboard.desc': 'Overview & Quick Controls',
  'sidebar.robot_control.desc': 'Manual Movement & Commands',
  'sidebar.sensors.desc': 'LiDAR, Camera, IMU Data',
  'sidebar.map2d.desc': 'Traditional Map Visualization',
  'sidebar.map_management.desc': 'Map & Task Management',
  'sidebar.map_management_status.desc': 'Current robot status and control',
  'sidebar.map_management_maps.desc': 'View and edit available maps',
  'sidebar.map_management_tasks.desc': 'Create and manage robot tasks',
  'sidebar.map3d.desc': 'Virtual Gazebo Environment',
  'sidebar.map_editor.desc': 'Create & Edit 2D Maps',
  'sidebar.charts.desc': 'Live Data Visualization',
  'sidebar.diagnostics.desc': 'System Health & Performance',
  'sidebar.logs.desc': 'Real-time Log Monitoring',
  'sidebar.parameters.desc': 'Node Configuration',
  'sidebar.nodes.desc': 'Start/Stop ROS Nodes',
  'sidebar.system_status.desc': 'Hardware & Software Status',
  'sidebar.system_guide.desc': 'Installation & Setup Guide',

  // Sensors small
  'sensors.status': 'Sensor Status',
  'sensors.ultrasonic': 'Ultrasonic',
};

const vi: Dict = {
  'app.title': 'Há»‡ Thá»‘ng Xe Tá»± HÃ nh Trong NhÃ ',
  'status.connected': 'ğŸŸ¢ ÄÃ£ káº¿t ná»‘i',
  'status.connecting': 'ğŸŸ¡ Äang káº¿t ná»‘i...',
  'status.disconnected': 'ğŸ”´ Máº¥t káº¿t ná»‘i',

  // Pages
  'page.dashboard': 'Báº£ng Ä‘iá»u khiá»ƒn',
  'page.robot-control': 'Äiá»u khiá»ƒn Robot',
  'page.navigation': 'Dáº«n Ä‘Æ°á»ng',
  'page.sensors': 'Cáº£m biáº¿n',
  'page.map-2d': 'Báº£n Ä‘á»“ 2D',
  'page.map-3d': 'Hiá»ƒn thá»‹ 3D',
  'page.map-editor': 'TrÃ¬nh sá»­a báº£n Ä‘á»“',
  'page.map-management-status': 'Quáº£n lÃ½ hiá»‡n tráº¡ng',
  'page.map-management-maps': 'Quáº£n lÃ½ maps',
  'page.map-management-tasks': 'Quáº£n lÃ½ nhiá»‡m vá»¥',
  'page.charts': 'Biá»ƒu Ä‘á»“ thá»i gian thá»±c',
  'page.diagnostics': 'Cháº©n Ä‘oÃ¡n',
  'page.logs': 'Nháº­t kÃ½ há»‡ thá»‘ng',
  'page.parameters': 'Tham sá»‘',
  'page.nodes': 'Quáº£n lÃ½ Node',
  'page.system-status': 'Tráº¡ng thÃ¡i há»‡ thá»‘ng',
  'page.system-guide': 'HÆ°á»›ng dáº«n há»‡ thá»‘ng',

  // Dashboard
  'dashboard.title': 'Báº£ng Ä‘iá»u khiá»ƒn',
  'dashboard.subtitle': 'Tá»•ng quan nhanh vÃ  Ä‘iá»u khiá»ƒn chÃ­nh',
  'dashboard.battery': 'Pin',
  'dashboard.speed': 'Tá»‘c Ä‘á»™',
  'dashboard.position': 'Vá»‹ trÃ­',
  'dashboard.lidar': 'LiDAR',
  'dashboard.lidar_points': 'Ä‘iá»ƒm phÃ¡t hiá»‡n',
  'dashboard.robot_status': 'Tráº¡ng thÃ¡i Robot',
  'dashboard.current_position': 'Vá»‹ trÃ­ hiá»‡n táº¡i',
  'dashboard.movement': 'Di chuyá»ƒn',
  'dashboard.speed_label': 'Tá»‘c Ä‘á»™',
  'dashboard.status': 'Tráº¡ng thÃ¡i',
  'dashboard.moving': 'ğŸŸ¢ Äang di chuyá»ƒn',
  'dashboard.stopped': 'â¸ï¸ Äang dá»«ng',
  'dashboard.power': 'Nguá»“n',
  'dashboard.nav_status': 'Tráº¡ng thÃ¡i dáº«n Ä‘Æ°á»ng',
  'dashboard.current_goal': 'Má»¥c tiÃªu hiá»‡n táº¡i',
  'dashboard.goal_status': 'Tráº¡ng thÃ¡i',
  'dashboard.no_active_goal': 'KhÃ´ng cÃ³ má»¥c tiÃªu',
  'dashboard.map_status': 'Tráº¡ng thÃ¡i báº£n Ä‘á»“',
  'dashboard.map_loaded': 'ğŸŸ¢ ÄÃ£ táº£i báº£n Ä‘á»“',
  'dashboard.no_map': 'ğŸ”´ ChÆ°a cÃ³ báº£n Ä‘á»“',
  'dashboard.path_planning': 'Láº­p káº¿ hoáº¡ch Ä‘Æ°á»ng Ä‘i',
  'dashboard.ready_for_nav': 'Sáºµn sÃ ng dáº«n Ä‘Æ°á»ng',
  'dashboard.system_health': 'Sá»©c khá»e há»‡ thá»‘ng',
  'dashboard.connections': 'Káº¿t ná»‘i',
  'dashboard.ros_nodes': 'ROS Nodes',
  'dashboard.active_nodes': 'Äang hoáº¡t Ä‘á»™ng',
  'dashboard.nodes': 'node',
  'dashboard.diagnostics': 'Cháº©n Ä‘oÃ¡n',
  'dashboard.all_ok': 'ğŸŸ¢ Há»‡ thá»‘ng á»•n Ä‘á»‹nh',
  'dashboard.no_diag': 'ğŸŸ¡ ChÆ°a cÃ³ cháº©n Ä‘oÃ¡n',
  'dashboard.quick_actions': 'TÃ¡c vá»¥ nhanh',
  'dashboard.emergency_stop': 'ğŸ›‘ Dá»«ng kháº©n cáº¥p',
  'dashboard.go_home': 'ğŸ  Vá» Home',
  'dashboard.start_nav': 'ğŸš€ Báº¯t Ä‘áº§u dáº«n Ä‘Æ°á»ng',
  'dashboard.system_overview': 'Tá»•ng quan há»‡ thá»‘ng',
  'dashboard.websocket_conn': 'Káº¿t ná»‘i WebSocket',
  'dashboard.ros_nodes_count': 'ROS Nodes',
  'dashboard.lidar_sensor': 'Cáº£m biáº¿n LiDAR',
  'dashboard.odometry': 'Odometry',

  // Robot Control
  'rc.title': 'Äiá»u khiá»ƒn Robot',
  'rc.subtitle': 'Äiá»u khiá»ƒn thá»§ cÃ´ng vÃ  lá»‡nh di chuyá»ƒn',
  'rc.mode.buttons': 'ğŸ”˜ NÃºt báº¥m',
  'rc.mode.basic': 'ğŸ® Joystick cÆ¡ báº£n',
  'rc.mode.advanced': 'ğŸš€ Joystick nÃ¢ng cao',
  'rc.robot_status': 'Tráº¡ng thÃ¡i Robot',
  'rc.position': 'Vá»‹ trÃ­',
  'rc.orientation': 'HÆ°á»›ng',
  'rc.velocity': 'Váº­n tá»‘c',
  'rc.battery': 'Pin',
  'rc.level': 'Má»©c',
  'rc.voltage': 'Äiá»‡n Ã¡p',
  'rc.sensors': 'Cáº£m biáº¿n',
  'rc.lidar_points': 'Sá»‘ Ä‘iá»ƒm LiDAR',
  'rc.emergency': 'Äiá»u khiá»ƒn kháº©n cáº¥p',
  'rc.emergency_stop': 'ğŸ›‘ Dá»ªNG KHáº¨N Cáº¤P',
  'rc.stop_movement': 'â¹ï¸ Dá»«ng di chuyá»ƒn',
  'rc.return_home': 'ğŸ  Vá» Home',
  'rc.instructions': 'HÆ°á»›ng dáº«n Ä‘iá»u khiá»ƒn',
  'rc.warn.not_connected': 'Robot chÆ°a káº¿t ná»‘i',
  'rc.speed_settings': 'Thiáº¿t láº­p tá»‘c Ä‘á»™',
  'rc.linear_speed': 'Tá»‘c Ä‘á»™ tháº³ng',
  'rc.angular_speed': 'Tá»‘c Ä‘á»™ gÃ³c',
  'rc.movement_control': 'Äiá»u khiá»ƒn di chuyá»ƒn',
  'rc.stop': 'Dá»«ng',
  'rc.home': 'Home',
  'rc.set_pose': 'Äáº·t Pose',
  'rc.current_speed': 'Tá»‘c Ä‘á»™ hiá»‡n táº¡i',
  'rc.current_angular': 'GÃ³c quay',
  'rc.snack.moving': 'ğŸ® Äang di chuyá»ƒn',
  'rc.snack.stopped': 'â¹ï¸ ÄÃ£ dá»«ng robot',
  'rc.snack.returning_home': 'ğŸ  Äang vá» Home...',
  'rc.manual_control': 'Äiá»u khiá»ƒn thá»§ cÃ´ng:',
  'rc.tip.use_buttons': 'DÃ¹ng cÃ¡c nÃºt mÅ©i tÃªn Ä‘á»ƒ di chuyá»ƒn',
  'rc.tip.adjust_speed': 'Äiá»u chá»‰nh tá»‘c Ä‘á»™ báº±ng thanh trÆ°á»£t',
  'rc.tip.emergency_stop': 'LuÃ´n cÃ³ nÃºt dá»«ng kháº©n cáº¥p',
  'rc.tip.realtime_feedback': 'Pháº£n há»“i tráº¡ng thÃ¡i theo thá»i gian thá»±c',
  'rc.safety_notes': 'LÆ°u Ã½ an toÃ n:',
  'rc.tip.monitor': 'LuÃ´n quan sÃ¡t xung quanh robot',
  'rc.tip.use_emg': 'DÃ¹ng dá»«ng kháº©n cáº¥p khi cáº§n',
  'rc.tip.check_battery': 'Kiá»ƒm tra pin thÆ°á»ng xuyÃªn',
  'rc.tip.clear_path': 'Äáº£m báº£o lá»™ trÃ¬nh thÃ´ng thoÃ¡ng trÆ°á»›c khi Ä‘i',

  // Map 2D
  'map2d.title': 'Báº£n Ä‘á»“ 2D',
  'map2d.refresh': 'LÃ m má»›i dá»¯ liá»‡u báº£n Ä‘á»“',
  'map2d.save_map': 'LÆ°u báº£n Ä‘á»“ hiá»‡n táº¡i',
  'map2d.rc_wasd': 'ğŸ® Äiá»u khiá»ƒn Robot (WASD)',
  'map2d.display_options': 'TÃ¹y chá»n hiá»ƒn thá»‹',
  'map2d.display_options_label': 'TÃ¹y chá»n hiá»ƒn thá»‹:',
  'map2d.show_lidar': 'Hiá»ƒn thá»‹ LiDAR',
  'map2d.show_path': 'Hiá»ƒn thá»‹ Ä‘Æ°á»ng Ä‘i',
  'map2d.show_goals': 'Hiá»ƒn thá»‹ má»¥c tiÃªu',
  'map2d.auto_center': 'Tá»± cÄƒn giá»¯a theo robot',
  'map2d.quick_nav': 'Äiá»u hÆ°á»›ng nhanh:',
  'map2d.go_home': 'ğŸ  Vá» Home (0, 0)',
  'map2d.point_a': 'ğŸ“ Äiá»ƒm A (2, 2)',
  'map2d.point_b': 'ğŸ“ Äiá»ƒm B (-2, 2)',
  'map2d.point_c': 'ğŸ“ Äiá»ƒm C (0, -2)',
  'map2d.cancel_goal': 'âŒ Há»§y má»¥c tiÃªu',
  'map2d.robot_status': 'Tráº¡ng thÃ¡i Robot:',
  'map2d.mode.initial': 'Äáº·t vá»‹ trÃ­ ban Ä‘áº§u',
  'map2d.mode.nav_goal': 'Má»¥c tiÃªu dáº«n Ä‘Æ°á»ng',
  // Map 2D - Controls
  'map2d.controls.title': 'ğŸ›ï¸ Äiá»u khiá»ƒn báº£n Ä‘á»“',
  'map2d.controls.map_source_title': 'ğŸ—ºï¸ Nguá»“n dá»¯ liá»‡u báº£n Ä‘á»“',
  'map2d.controls.static_map': 'Báº£n Ä‘á»“ tÄ©nh',
  'map2d.controls.dynamic_map': 'Báº£n Ä‘á»“ Ä‘á»™ng',
  'map2d.controls.map_source.desc.static': 'Sá»­ dá»¥ng báº£n Ä‘á»“ tÄ©nh cÃ³ sáºµn',
  'map2d.controls.map_source.desc.dynamic': 'Sá»­ dá»¥ng báº£n Ä‘á»“ SLAM theo thá»i gian thá»±c',
  'map2d.controls.position_mode_title': 'ğŸ“ Cháº¿ Ä‘á»™ vá»‹ trÃ­ Robot',
  'map2d.controls.receive_from_ros': 'Nháº­n tá»« ROS',
  'map2d.controls.send_to_ros': 'Gá»­i lÃªn ROS',
  'map2d.controls.position.desc.receive': 'Cáº­p nháº­t vá»‹ trÃ­ tá»« ROS',
  'map2d.controls.position.desc.send': 'Báº¥m lÃªn báº£n Ä‘á»“ Ä‘á»ƒ Ä‘áº·t vá»‹ trÃ­ ban Ä‘áº§u',
  'map2d.controls.position.alert': 'Báº¥m lÃªn báº£n Ä‘á»“ Ä‘á»ƒ Ä‘áº·t vá»‹ trÃ­ ban Ä‘áº§u cá»§a robot',
  'map2d.controls.running_mode_title': 'ğŸ¤– Cháº¿ Ä‘á»™ cháº¡y cá»§a Robot',
  'map2d.controls.line_following': 'Äi theo line',
  'map2d.controls.slam_auto': 'SLAM tá»± Ä‘á»™ng',
  'map2d.controls.running.desc.line_following': 'Robot Ä‘i theo tuyáº¿n Ä‘á»‹nh sáºµn',
  'map2d.controls.running.desc.slam': 'Tá»± hÃ nh vá»›i SLAM',
  'map2d.controls.multi_goal_title': 'ğŸ“Œ Cháº¿ Ä‘á»™ Ä‘a má»¥c tiÃªu',
  'map2d.controls.multiple_goals': 'Nhiá»u má»¥c tiÃªu',
  'map2d.controls.single_goal': 'Má»™t má»¥c tiÃªu',
  'map2d.controls.multi_goal.disabled': 'Bá»‹ vÃ´ hiá»‡u khi Ä‘ang Ä‘áº·t vá»‹ trÃ­ ban Ä‘áº§u',
  'map2d.controls.multi_goal.hint_multi': 'Chá»n nhiá»u má»¥c tiÃªu; kÃ©o Ä‘á»ƒ Ä‘áº·t hÆ°á»›ng',
  'map2d.controls.multi_goal.hint_single': 'Chá»n má»™t má»¥c tiÃªu',
  'map2d.controls.selected': 'ÄÃ£ chá»n',
  'map2d.controls.run': 'Cháº¡y',
  'map2d.controls.clear': 'XÃ³a',
  'map2d.wasd.press_to_move': 'Nháº¥n phÃ­m WASD Ä‘á»ƒ di chuyá»ƒn',
  // Map 2D - Legend
  'map2d.legend.title': 'ğŸ—‚ï¸ ChÃº giáº£i & HÆ°á»›ng dáº«n',
  'map2d.legend.elements_title': 'ğŸ¨ CÃ¡c thÃ nh pháº§n báº£n Ä‘á»“:',
  'map2d.legend.green_circle': 'ğŸŸ¢ VÃ²ng trÃ²n xanh lÃ¡: Vá»‹ trÃ­ robot',
  'map2d.legend.blue_line': 'ğŸ”µ ÄÆ°á»ng xanh dÆ°Æ¡ng: HÆ°á»›ng robot',
  'map2d.legend.green_dots': 'ğŸŸ¢ CÃ¡c cháº¥m xanh lÃ¡: Äiá»ƒm quÃ©t LiDAR',
  'map2d.legend.brown_rects': 'ğŸŸ¤ HÃ¬nh chá»¯ nháº­t nÃ¢u: Váº­t cáº£n/tÆ°á»ng',
  'map2d.legend.white_areas': 'âšª VÃ¹ng tráº¯ng: KhÃ´ng gian trá»‘ng',
  'map2d.legend.gray_areas': 'ğŸ”² VÃ¹ng xÃ¡m: KhÃ´ng xÃ¡c Ä‘á»‹nh',
  'map2d.legend.interaction_title': 'ğŸ–±ï¸ TÆ°Æ¡ng tÃ¡c:',
  'map2d.legend.interaction.click': 'Click: Äáº·t má»¥c tiÃªu dáº«n Ä‘Æ°á»ng',
  'map2d.legend.interaction.wasd': 'PhÃ­m WASD: Di chuyá»ƒn robot trá»±c tiáº¿p',
  'map2d.legend.interaction.control_panel': 'Báº£ng Ä‘iá»u khiá»ƒn: WASD trá»±c quan á»Ÿ gÃ³c dÆ°á»›i pháº£i',
  'map2d.legend.interaction.fullscreen': 'ToÃ n mÃ n hÃ¬nh: Má»Ÿ cháº¿ Ä‘á»™ toÃ n mÃ n hÃ¬nh',
  'map2d.legend.tips_title': 'âš ï¸ Máº¹o Ä‘iá»u khiá»ƒn:',
  'map2d.legend.tips.wasd': 'WASD: W=Tiáº¿n, S=LÃ¹i, A=TrÃ¡i, D=Pháº£i',
  'map2d.legend.tips.stop': 'NÃºt dá»«ng: Báº¥m nÃºt Ä‘á» hoáº·c tháº£ phÃ­m',
  'map2d.legend.tips.navigation': 'Dáº«n Ä‘Æ°á»ng: Báº¥m vÃ o vÃ¹ng trá»‘ng (mÃ u tráº¯ng)',
  'map2d.legend.tips.manual': 'Äiá»u khiá»ƒn tay: DÃ¹ng WASD Ä‘á»ƒ chá»‰nh chÃ­nh xÃ¡c',
  'map2d.legend.tips.mapping': 'XÃ¢y dá»±ng báº£n Ä‘á»“: Di chuyá»ƒn robot Ä‘á»ƒ khÃ¡m phÃ¡ khu vá»±c',
  'map2d.legend.tips.monitor': 'Theo dÃµi tiáº¿n trÃ¬nh vÃ  trÃ¡nh váº­t cáº£n',
  'map.instruction.initial': 'ğŸ“ Báº¥m Ä‘á»ƒ chá»n vá»‹ trÃ­, báº¥m láº§n ná»¯a Ä‘á»ƒ chá»n hÆ°á»›ng',
  'map.instruction.goal': 'ğŸ“ Báº¥m lÃªn báº£n Ä‘á»“ Ä‘á»ƒ Ä‘áº·t má»¥c tiÃªu',
  'map.info.fallback': '(Äang dÃ¹ng báº£n Ä‘á»“ táº¡m â€” chÆ°a cÃ³ dá»¯ liá»‡u tá»« ROS)',
  'map.info.resolution': 'Äá»™ phÃ¢n giáº£i',
  'map.info.size': 'KÃ­ch thÆ°á»›c',
  'map.info.robot': 'Robot',
  'map.header.interactive': 'ğŸ—ºï¸ Báº£n Ä‘á»“ tÆ°Æ¡ng tÃ¡c',
  'map.fullscreen': 'ToÃ n mÃ n hÃ¬nh',
  'map.dialog.title': 'ğŸ—ºï¸ Báº£n Ä‘á»“ - ToÃ n mÃ n hÃ¬nh',
  'map.viewer.no_data.title': 'ChÆ°a cÃ³ dá»¯ liá»‡u báº£n Ä‘á»“',
  'map.viewer.no_data.subtitle': 'Báº£n Ä‘á»“ sáº½ hiá»ƒn thá»‹ khi sáºµn sÃ ng',
  'map.viewer.zoom_in': 'PhÃ³ng +',
  'map.viewer.zoom_out': 'Thu -',
  'map.viewer.reset': 'Äáº·t láº¡i',
  // Sidebar
  'sidebar.header.title': 'Xe tá»± hÃ nh',
  'sidebar.header.subtitle': 'Giao diá»‡n Ä‘iá»u khiá»ƒn web',
  'sidebar.cat.main': 'ğŸ® Äiá»u khiá»ƒn chÃ­nh',
  'sidebar.cat.monitoring': 'ğŸ“Š GiÃ¡m sÃ¡t',
  'sidebar.cat.tools': 'ğŸ”§ CÃ´ng cá»¥',
  'sidebar.cat.system': 'âš™ï¸ Há»‡ thá»‘ng',
  'sidebar.dashboard.desc': 'Tá»•ng quan & Ä‘iá»u khiá»ƒn nhanh',
  'sidebar.robot_control.desc': 'Äiá»u khiá»ƒn thá»§ cÃ´ng & lá»‡nh',
  'sidebar.sensors.desc': 'Dá»¯ liá»‡u LiDAR, Camera, IMU',
  'sidebar.map2d.desc': 'Hiá»ƒn thá»‹ báº£n Ä‘á»“ truyá»n thá»‘ng',
  'sidebar.map_management.desc': 'Quáº£n lÃ½ báº£n Ä‘á»“ & nhiá»‡m vá»¥',
  'sidebar.map_management_status.desc': 'Tráº¡ng thÃ¡i vÃ  Ä‘iá»u khiá»ƒn robot',
  'sidebar.map_management_maps.desc': 'Xem vÃ  chá»‰nh sá»­a báº£n Ä‘á»“ cÃ³ sáºµn',
  'sidebar.map_management_tasks.desc': 'Táº¡o vÃ  quáº£n lÃ½ nhiá»‡m vá»¥ robot',
  'sidebar.map3d.desc': 'MÃ´i trÆ°á»ng áº£o (giá»‘ng Gazebo)',
  'sidebar.map_editor.desc': 'Táº¡o & chá»‰nh sá»­a báº£n Ä‘á»“ 2D',
  'sidebar.charts.desc': 'Biá»ƒu Ä‘á»“ dá»¯ liá»‡u trá»±c tiáº¿p',
  'sidebar.diagnostics.desc': 'Sá»©c khá»e & hiá»‡u nÄƒng há»‡ thá»‘ng',
  'sidebar.logs.desc': 'Theo dÃµi log thá»i gian thá»±c',
  'sidebar.parameters.desc': 'Cáº¥u hÃ¬nh node',
  'sidebar.nodes.desc': 'Khá»Ÿi Ä‘á»™ng/dá»«ng cÃ¡c node ROS',
  'sidebar.system_status.desc': 'Tráº¡ng thÃ¡i pháº§n cá»©ng & pháº§n má»m',
  'sidebar.system_guide.desc': 'HÆ°á»›ng dáº«n cÃ i Ä‘áº·t & thiáº¿t láº­p',

  // Sensors small
  'sensors.status': 'Tráº¡ng thÃ¡i cáº£m biáº¿n',
  'sensors.ultrasonic': 'SiÃªu Ã¢m',
};

const DICTS: Record<Language, Dict> = { en, vi };

interface I18nContextValue {
  lang: Language;
  setLang: (l: Language) => void;
  t: (key: string, fallback?: string) => string;
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

const STORAGE_KEY = 'app.lang';

export const I18nProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [lang, setLangState] = useState<Language>(() => {
    const saved = (localStorage.getItem(STORAGE_KEY) || '').toLowerCase();
    return saved === 'vi' || saved === 'en' ? (saved as Language) : 'vi';
  });

  useEffect(() => {
    try { localStorage.setItem(STORAGE_KEY, lang); } catch {}
  }, [lang]);

  const setLang = useCallback((l: Language) => setLangState(l), []);

  const t = useCallback((key: string, fallback?: string) => {
    const dict = DICTS[lang] || {};
    return dict[key] ?? fallback ?? DICTS.en[key] ?? key;
  }, [lang]);

  const value = useMemo(() => ({ lang, setLang, t }), [lang, setLang, t]);

  return (
    <I18nContext.Provider value={value}>
      {children}
    </I18nContext.Provider>
  );
};

export const useI18n = () => {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error('useI18n must be used within I18nProvider');
  return ctx;
};
